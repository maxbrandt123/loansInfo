<html>
<head>
    <title>test doc</title>
    <link rel="stylesheet" type="text/css" href="loanInfoPage.css">
    <meta name="resource-type" content="document">

    </script>

<script language="JavaScript">

var num=0;
var amt=0;
var per=0;
var months=0;
var nls="";
var rr="\r";
var b="                               ";
var d="-----------------------------"+"----------------------------------";
var s="$";
function iA(){
 this.length=iA.arguments.length;
 for (var i=0;i<this.length;i++){
  this[i]=iA.arguments[i];
  }
 }
var pwr=new iA(10);
var decimal=new iA(16);
pwr[0]=1;
for (var i=0;i<9;i++){
 pwr[i+1]=pwr[i]*10;
}
decimal[0]=.1;
decimal[1]= 0.01;
decimal[2]= 0.001;
decimal[3]= 0.0001;
decimal[4]= 0.00001;
decimal[5]= 0.000001;
decimal[6]= 0.0000001;
decimal[7]= 0.00000001;
decimal[8]= 0.000000001;
decimal[9]= 0.0000000001;
decimal[10]= 0.00000000001;
decimal[11]= 0.000000000001;
decimal[12]= 0.0000000000001;
decimal[13]= 0.00000000000001;
decimal[14]= 0.000000000000001;
decimal[15]= 0.0000000000000001;

var numbers="01234567890";
var cr="";
var str="";

function stn(){
 num=0;
 pos=str.indexOf(".");
 sfx="";
 if (pos>-1){
  sfx=str.substring(pos+1,str.length);
  str=str.substring(0,pos);
  }
 strl=str.length;
 for (var i=strl-1;i>-1;i--){
  cr=str.substring(i,i+1);
  pos=numbers.indexOf(cr);
  num+=pos*pwr[strl-i-1];
  }
  if (sfx!=""&&sfx.length>dp){
   pos=numbers.indexOf(sfx.charAt(dp+1));
   if (pos>4){
    pos=numbers.indexOf(sfx.charAt(dp));
    sfx=sfx.substring(0,dp-1)+(pos+1);
    }
   }
  if (sfx!=""){
   for (var i=0;i<dp;i++){
    cr=sfx.substring(i,i+1);
    pos=numbers.indexOf(cr);
    num+=pos*decimal[i];
    }
/*    sfx="";
    sfx+=num;
    pos=sfx.indexOf(".");
    sfx=sfx.substring(pos+1,sfx.length);
    if (sfx.charAt(dp+1)=="9"){
     num+=decimal[sfx.length-2];
     } */
  }
 }

function testIt(form){
 str=document.isn.amt.value;
 fmtIt();
 bl=str.length+3;
 dp=2;
 stn();
 amt=num;
 str=document.isn.per.value;
 dp=4;
 stn();
 per=num;
 str=document.isn.months.value;
 dp=0;
 stn();
 months=num;
 if (months<1||months>999||per<.0001||per>99||amt<1||amt>pwr[9]){
  alert();
  }
 else{
 computeForm();
 }
}

function computeForm(){
 ls="";
 isn2=1;
 i=per/12/100;
 fpv=0;
 for (var j=0;j<months;j++)
  isn2=isn2*(1+i);
  tmp=(amt*isn2*i)/(isn2-1);
  fpv+=tmp;
  fcalc=((months*fpv)-amt);

 prtSched();
 }

function prtSched(){
 fpv+=.01;
 str=""
 str+=fpv;
 fmtIt();
 dp=2;
 stn();
 fpv=num;
 pct=per/12/100;
 if (bl<14){
  bl=14;
  }
 ls="Amortization Schedule: "+document.isn.months.value
 +" months to repay "+s+document.isn.amt.value
 +" at "+document.isn.per.value+"% interest."+rr+d+rr

 for (var j=0;j<months;j++){
  ntr=(amt*pct);
  str="";
  str+=ntr;
  fmtIt();
  ntr1=s+str;
  prp=fpv-ntr;
  if (prp>amt){
   prp=amt;
   }
  str="";
  str+=prp;
  fmtIt();
  prp1=s+str;
  amt-=prp;
  str="";
  str+=amt;
  fmtIt();
  amt1=s+str;
  if (fpv>(ntr+prp)){
   fpv=ntr+prp;
   }
  str="";
  str+=fpv;
  fmtIt();
  fpv1=s+str;
  str="";
  str+=(j+1)+".";
  ls+=b.substring(0,2)+str+b.substring(0,12-str.length)
  +fpv1+b.substring(0,14-fpv1.length)+ntr1
  +b.substring(0,14-ntr1.length)+prp1
  +b.substring(0,14-prp1.length)+amt1
  +rr;
  }
  document.isn.sched.value=ls+d+rr

 }
function fmtIt(){
 pos=str.indexOf(".");
 if (pos==0){
  str="0"+str;
  pos++;
  }
 if (pos<0){
  str+=".00";
  pos=str.indexOf(".");
  }
 str+="0000";
 str=str.substring(0,pos+4);
 cr=str.charAt(str.length-1);
 pos=numbers.indexOf(cr);
 str=str.substring(0,str.length-1);
 if (pos>5){
  fmtIt1();
  }
 }
 function fmtIt1(){
  for (var k=str.length-1;k>-1;k--){
   cr=str.charAt(k);
   posn=numbers.indexOf(cr);
   if (posn<0){
    k--;
   }
   else{
    str=str.substring(0,k)+numbers.substring(posn+1,posn+2)
    +str.substring(k+1,str.length);
    if (posn!=9){
     k=-1;
    }
   }
  }
 }
function alert(){
 alert('invalid inputs');
}

</script>

</head>

<body>

<div align="center">
    <form name="isn">
        <table width="80%" border="10">
            <tbody>
            <tr valign="top">
                <th align="center">
                    <p>Loan Term in Months</p>
                </th>
                <th align="center" height="2" width="15" border="0">
                    <p>Rate</p>
                </th>
                <th align="center">
                    <p>Amount in USD</p>
                </th>
            </tr>
            <tr valign="middle" padding="20">
                <td align="center"><input type="text" name="months" value="36" size="3"> Months
                <td align="center"><input type="text" name="per" value="4" size="2">%
                <td align="center"><input type="text" name="amt" value="10000" size="8">$</td>


            </tr>

            <tr>
                <td colspan="3" align="center" valign="middle">
                    <textarea name="sched" rows="20" cols="75"></textarea>
                    <table style="width:100%">
                        <tr>
                            <th>Month</th>
                            <th>Beginning Balance</th>
                            <th>Interest</th>
                            <th>Payment</th>
                            <th>Balance</th>
                        </tr>

                        <tr>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>

                        </tr>

                        <tr>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>

                        <tr>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                    </table>
            </tbody>

            </td>
            </tr>
            <tr>

                <td colspan="3" align="center"><input type="button" value="Calculate" onclick="testIt(this.form)"></td>
            </tr>

            </tbody>


        </table>
    </form>
</div>


<div align="center">

    <tbody>
    <tr align="left" valign="middle">
        <td colspan="4"></td>
    </tr>


</div>
</small>
</body>
</html>